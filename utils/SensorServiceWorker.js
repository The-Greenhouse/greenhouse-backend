const obj = {
    "Sheet1": [
        {
            "20": "20",
            "1-Jan-22": "2-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "3-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "4-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "5-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "6-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "7-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "8-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "9-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "10-Jan-22"
        },
        {
            "20": "20",
            "1-Jan-22": "11-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "12-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "13-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "14-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "15-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "16-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "17-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "18-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "19-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "20-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "21-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "22-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "23-Jan-22"
        },
        {
            "20": "21",
            "1-Jan-22": "24-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "25-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "26-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "27-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "28-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "29-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "30-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "31-Jan-22"
        },
        {
            "20": "22",
            "1-Jan-22": "1-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "2-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "3-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "4-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "5-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "6-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "7-Feb-22"
        },
        {
            "20": "22",
            "1-Jan-22": "8-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "9-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "10-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "11-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "12-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "13-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "14-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "15-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "16-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "17-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "18-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "19-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "20-Feb-22"
        },
        {
            "20": "23",
            "1-Jan-22": "21-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "22-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "23-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "24-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "25-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "26-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "27-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "28-Feb-22"
        },
        {
            "20": "24",
            "1-Jan-22": "1-Mar-22"
        },
        {
            "20": "24",
            "1-Jan-22": "2-Mar-22"
        },
        {
            "20": "24",
            "1-Jan-22": "3-Mar-22"
        },
        {
            "20": "24",
            "1-Jan-22": "4-Mar-22"
        },
        {
            "20": "24",
            "1-Jan-22": "5-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "6-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "7-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "8-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "9-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "10-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "11-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "12-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "13-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "14-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "15-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "16-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "17-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "18-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "19-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "20-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "21-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "22-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "23-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "24-Mar-22"
        },
        {
            "20": "25",
            "1-Jan-22": "25-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "26-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "27-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "28-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "29-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "30-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "31-Mar-22"
        },
        {
            "20": "26",
            "1-Jan-22": "1-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "2-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "3-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "4-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "5-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "6-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "7-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "8-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "9-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "10-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "11-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "12-Apr-22"
        },
        {
            "20": "26",
            "1-Jan-22": "13-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "14-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "15-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "16-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "17-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "18-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "19-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "20-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "21-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "22-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "23-Apr-22"
        },
        {
            "20": "27",
            "1-Jan-22": "24-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "25-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "26-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "27-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "28-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "29-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "30-Apr-22"
        },
        {
            "20": "28",
            "1-Jan-22": "1-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "2-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "3-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "4-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "5-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "6-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "7-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "8-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "9-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "10-May-22"
        },
        {
            "20": "28",
            "1-Jan-22": "11-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "12-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "13-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "14-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "15-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "16-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "17-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "18-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "19-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "20-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "21-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "22-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "23-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "24-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "25-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "26-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "27-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "28-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "29-May-22"
        },
        {
            "20": "29",
            "1-Jan-22": "30-May-22"
        },
        {
            "20": "30",
            "1-Jan-22": "31-May-22"
        },
        {
            "20": "30",
            "1-Jan-22": "1-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "2-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "3-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "4-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "5-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "6-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "7-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "8-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "9-Jun-22"
        },
        {
            "20": "30",
            "1-Jan-22": "10-Jun-22"
        }
    ]
}



// Returns an array of dates between the two dates
function getDates (startDate, endDate) {
    const dates = []
    let currentDate = startDate
    const addDays = function (days) {
        const date = new Date(this.valueOf())
        date.setDate(date.getDate() + days)
        return date
    }
    while (currentDate <= endDate) {
        dates.push(currentDate)
        currentDate = addDays.call(currentDate, 1)
    }
    return dates
}
  



const SensorServiceWorker = (startDate, endDate) => {
    
    const data = new Map();
    for (index = 0; index < obj.Sheet1.length; index++) {
        const io = (obj.Sheet1[index]);
        const a = (io["1-Jan-22"]);
        const b = (io["20"]);
        data[a] = b;
    }
    //   // Usage
    const response = new Map();
    const dates = getDates(new Date(startDate), new Date(endDate))
    dates.forEach(function (date) {
        let dateString = date.toDateString();
        let month = dateString.substring(4,7);
        let day = dateString.substring(8,10);
        var dayint = parseInt(day, 10);
        const final = dayint+'-'+month+'-'+'22';
        response[final] = data[final];
    })    
    return response;
}

module.exports = SensorServiceWorker;